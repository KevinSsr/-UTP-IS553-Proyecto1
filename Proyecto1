package com.mycompany.proyecto1;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.InputMismatchException;
import java.util.Scanner;
import javax.swing.JOptionPane;

public class Agenda {
    
    private Contacto[] contactos;
    
    public Agenda(){
        this.contactos = new Contacto[20];
    }
    
    public Agenda(int tamaño){
        tamaño=15;
        this.contactos = new Contacto[tamaño];
    }
    
    public void añadirContacto(Contacto c){ 
        
        if(this.verificarContacto(c)){
            System.out.println("El contacto con ese nombre ya existe");
        }
        else if(agendaLlena()){
           System.out.println("La agenda esta llena, no se pueden meter mas contactos");
        } 
        
             else{
            if (this.verificarTelefono(c)){
                System.out.println("El contacto con este telefono ya existe");
            }
            else {
             boolean encontrado = false;  
             for(int i=0;i<contactos.length && !encontrado;i++){
                if(contactos[i]==null){
                    contactos[i]=c;
                    encontrado=true;
                }
             }
   
            if(encontrado){
                System.out.println("Se ha añadido");
            }else{
                System.out.println("No se ha podido añadir");
            }
        }
     }
   }
   
   public boolean verificarContacto(Contacto c){
       
       
        for(int i=0;i<contactos.length;i++){
            if(contactos[i]!=null && c.equals(contactos[i])){
                return true;
            }
        }
        return false;
        
   }
   public boolean verificarTelefono(Contacto c){
       
       
        for(int i=0;i<contactos.length;i++){
            if(contactos[i]!=null && c.equalst(contactos[i])){
                return true;
            }
        }
        return false;
        
   }
   
   public void listarContactos(){
        
       int contador = 0;
        for(int i=0;i<contactos.length;i++){
            if(contactos[i]!=null){
                System.out.println(contactos[i]);  
            }
            if(contactos[i]==null) {
               contador++;
            }
            
        }
        
        if(contador==contactos.length)
        {
            System.out.println("No hay contactos");
        }
   }
   public void modificarContacto(Contacto c){
       
       Scanner sn = new Scanner(System.in);
       sn.useDelimiter("\n");
       boolean encontrado = false;
       double telefono;
       String nombre;
       String correo;
       String lugar; 
       for(int i=0;i<contactos.length && !encontrado;i++){
           if(contactos[i]!=null && contactos[i].equals(c)){
              System.out.println("Su teléfono es: " + contactos[i].getTelefono());
              System.out.println("Su correo es: " + contactos[i].getCorreo());
              System.out.println("El lugar es: " + contactos[i].getLugar());
               System.out.println("Ingresa lo que deseas modificar de este contacto: ");
                encontrado = true;
                 }
                   try
                    {
                       System.out.println("Escribe un nombre nuevo: ");
                        contactos[i]=null;
                        nombre = sn.next();
                        System.out.println("Escribe un telefono nuevo");
                        telefono = sn.nextInt();
                        System.out.println("Escribe un correo nuevo");
                        correo = sn.next();
                        System.out.println("Escribe un lugar nuevo");
                        lugar =sn.next();
                        while(lugar.trim().isEmpty()){
                            System.out.println("El lugar es obligatorio");
                            lugar =sn.next();
                            c = new Contacto(nombre, correo, (int) telefono, lugar);
                            this.añadirContacto(c);
                            
             }
               break;
                        
              }catch (InputMismatchException e) {
                System.out.println("Tienes que insertar un número");
                sn.next();
                sn.next();
              }
           }
         
       }
   
   public void buscarPorNombre(String nombre){
       boolean encontrado = false;
       for(int i=0;i<contactos.length && !encontrado;i++){
           if(contactos[i]!=null && contactos[i].getNombre().equalsIgnoreCase(nombre)){
              System.out.println("Su teléfono es: " + contactos[i].getTelefono());
              System.out.println("Su correo es: " + contactos[i].getCorreo());
              System.out.println("El lugar es: " + contactos[i].getLugar());
              encontrado = true;
           }
       }
       
        
       if(!encontrado){
           System.out.println("No se ha encontrado el contacto");
       }
       
   }
   public void CrearArchivo (String nombre) throws IOException{
       File f;
       FileWriter w;
       BufferedWriter bw;
       PrintWriter wr;
       
       try{
           f= new File(nombre);
           w= new FileWriter(f);
           bw= new BufferedWriter(w);
           wr= new PrintWriter(bw);
           boolean encontrado = false;
           
           for(int i=0;i<contactos.length && !encontrado;i++){
           if(contactos[i]!=null && contactos[i].getNombre().equalsIgnoreCase(nombre)){
              wr.write("Nombre: " + contactos[i].getNombre());
              wr.write(" ; ");
              wr.write("Telefono: " + contactos[i].getTelefono());
              wr.write(" ; ");
              wr.write("Correo: " + contactos[i].getCorreo());
              wr.write(" ; ");
              wr.write("Lugar: " + contactos[i].getLugar());
              encontrado = true;
               System.out.println("Se ha creado el archivo");
           }
       }
           wr.close();
           bw.close();
        }
       catch (IOException e){
        JOptionPane.showMessageDialog(null, "Ha ocurrido un error"+ e);
                  
       }
           
   }
   public void ImportarArchivo (String nombre) throws FileNotFoundException {
       File archivo;
       FileReader fr;
       BufferedReader br;
       
       try {
           archivo = new File (nombre);
           fr=new FileReader(archivo);
           br= new BufferedReader (fr);
           
           String linea;
           while((linea=br.readLine())!=null){
               System.out.println(linea);
               System.out.println("El contacto se ha importado");      
          }  
           br.close();
           fr.close();
       } catch (IOException e) {
           JOptionPane.showMessageDialog(null, "Hubo un error leyendo el archivo"+e);
       }
       
    }
   public boolean agendaLlena(){
       
       for (int i = 0; i < contactos.length; i++){
           if(contactos[i] == null){
               return false;
           }
       }
       
       return true;
       
   }
   
   public void eliminarContacto(Contacto c){
       
       boolean encontrado = false;
       for(int i=0;i<contactos.length && !encontrado;i++){
           if(contactos[i]!=null && contactos[i].equals(c)){
              contactos[i]=null;
              System.out.println("Contacto eliminado");
              encontrado = true;
           }
       }
       
       if(!encontrado){
           System.out.println("No se ha eliminado el contacto");      
       }
   }
   
   public int huecosLibre(){
       int contador = 0;
       for(int i=0;i<contactos.length;i++){
           if(contactos[i]==null){
              contador++;
           }
       }
       
       return contador;
   }
}
